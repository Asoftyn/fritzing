<html xmlns="http://www.w3.org/1999/xhtml" xmlns:tal="http://xml.zope.org/namespaces/tal" xmlns:metal="http://xml.zope.org/namespaces/metal" xmlns:i18n="http://xml.zope.org/namespaces/i18n" xml:lang="en" lang="en" metal:use-macro="context/main_template/macros/master" i18n:domain="fritzing.fab">
  <head>
      <metal:block fill-slot="style_slot">
          <link rel="stylesheet" type="text/css" 
              tal:define="navroot context/@@plone_portal_state/navigation_root_url"
              tal:attributes="href string:${navroot}/++resource++fritzing.fab/styles.css"
              />
      </metal:block>
      <metal:block fill-slot="javascript_head_slot">
          <script type="text/javascript" 
              tal:define="navroot context/@@plone_portal_state/navigation_root_url"
              tal:attributes="src string:${navroot}/++resource++fritzing.fab/fab.js"
              >
          </script>
      </metal:block>
  </head>
  <body>
    <metal:main fill-slot="main">
      <tal:main-macro metal:define-macro="main">
        <h1 tal:condition="not:view/isOrdered" class="documentFirstHeading">Order your PCBs</h1>
        <h1 tal:condition="view/isOrdered" class="documentFirstHeading">Review your Order</h1>
        <div id="content-core">
          
          
          <h2 tal:condition="not:view/isOrdered">Step 1: Upload your sketches</h2>
          <h2 tal:condition="view/isOrdered">Sketches</h2>
          
          <div tal:condition="not:container/listFolderContents">
            <p>no sketches, bla bla</p>
            <a class="addSketchLink" href="#" tal:attributes="href string:${context/absolute_url}/++add++sketch">Add Sketch</a>
          </div>
          
          <table class="sketchesTable" tal:condition="container/listFolderContents">
            <tbody>
              <tr tal:condition="not:view/isOrdered">
                <td class="actionCell"><a class="addSketchLink" href="#" tal:attributes="href string:${context/absolute_url}/++add++sketch">Add a sketch</a></td>
                <td></td>
                <td tal:condition="not:view/isOrdered"></td>
              </tr>
              <tr tal:repeat="item container/listFolderContents">
                <td class="sketchCell">
                  <div>
                    <span tal:content="item/copies"></span>&nbsp;&times; 
                    <span tal:content="item/orderItem/filename | string:error">filename</span>
                  </div>
                  <table class="boardPreviewTable">
                    <tr>
                      <td class="boardPreview" 
                        tal:attributes="style python: 'width: %.2fcm;; height: %.02fcm;;' % (item.width/2.0, item.height/2.0)" 
                        tal:content="python: '%.2f&nbsp;cm&sup2;' % (item.area)">
                      </td>
                      <td tal:content="python: '%.2f&nbsp;cm' % (item.height)"></td>
                    </tr>
                    <tr>
                      <td tal:content="python: '%.2f&nbsp;cm' % (item.width)"></td>
                      <td></td>
                    </tr>
                  </table>
                  <div tal:condition="item/check">+ Quality check</div>
                </td>
                <td class="priceCell">
                  <div tal:content="python: '%.2f&nbsp;EUR' % (item.copies * item.area * context.pricePerSquareCm)"></div>
                  <div tal:condition="item/check">10.00&nbsp;EUR</div>
                </td>
                <td class="actionCell" tal:condition="not:view/isOrdered">
                  <a class="editSketchLink" tal:condition="view/isManager" href="#" tal:attributes="href string:${item/absolute_url}/edit">edit</a><br />
                  <a class="deleteSketchLink" href="#" tal:attributes="href string:${item/absolute_url}/delete_confirmation">delete</a>
                </td>
              </tr>
              <tr>
                <td class="actionCell"><a tal:condition="not:view/isOrdered" class="addSketchLink" href="#" tal:attributes="href string:${context/absolute_url}/++add++sketch">Add a sketch</a></td>
                <td class="sumCell priceCell" tal:content="python: '%.2f&nbsp;EUR' % (context.priceTotalNetto)"></td>
                <td tal:condition="not:view/isOrdered"></td>
              </tr>
            </tbody>
          </table>
          
          
          <div tal:condition="python: (context.area > 0)">
            <h2 tal:condition="not:view/isOrdered">Step 2: Provide shipping and contact information</h2>
            <h2 tal:condition="view/isOrdered">Shipping and contact information</h2>
          
            <div tal:condition="python: not context.shipTo">
              <p>
                please add your e-mail address and shipping destination to complete your order:<br />
                <a class="editAddressLink" href="#" tal:attributes="href string:${context/absolute_url}/edit">Add a shipping destination</a>
              </p>
            </div>
          
            <table class="plain" tal:condition="python: context.shipTo">
              <tr>
                <td>E-Mail: </td>
                <td tal:content="context/email"></td>
              </tr>
              <tr>
                <td>Shipping Area: </td>
                <td tal:content="context/shipTo"></td>
              </tr>
              <tr tal:condition="not:view/isOrdered">
                <td colspan="2"><a class="editAddressLink" href="#" tal:attributes="href string:${context/absolute_url}/edit">Edit</a></td>
              </tr>
            </table>
          </div>
          
          
          <div tal:condition="python: (context.area > 0 and context.shipTo and context.email)">
        
            <h2 tal:condition="not:view/isOrdered">Step 3: Review your order</h2>
            <h2 tal:condition="view/isOrdered">Summary</h2>
        
            <table class="plain">
              <tr>
                <td tal:content="python: '%.2f&nbsp;cm&sup2;' % (context.area)"></td>
                <td>PCB Area (<span tal:content="context/pricePerSquareCm"></span>&nbsp;EUR/cm&sup2;)</td>
                <td tal:content="python: '%.2f&nbsp;EUR' % (context.priceNetto)"></td>
              </tr>
              <tr tal:condition="python: (context.numberOfQualityChecks > 0)">
                <td><span tal:content="context/numberOfQualityChecks"></span>&times;</td>
                <td>Sketch quality check</td>
                <td tal:content="python: '%.2f&nbsp;EUR' % (context.priceQualityChecksNetto)"></td>
              </tr>
              <tr>
                <td></td>
                <td>Total Netto</td>
                <td tal:content="python: '%.2f&nbsp;EUR' % (context.priceTotalNetto)"></td>
              </tr>
              <tr>
                <td></td>
                <td>Taxes (<span tal:content="context/taxesPercent"></span>%)</td>
                <td tal:content="python: '%.2f&nbsp;EUR' % (context.taxes)"></td>
              </tr>
              <tr>
                <td></td>
                <td>Shipping</td>
                <td tal:content="python: '%.2f&nbsp;EUR' % (context.priceShipping)"></td>
              </tr>
              <tr>
                <td></td>
                <td>Total</td>
                <td tal:content="python: '%.2f&nbsp;EUR' % (context.priceTotalBrutto)"></td>
              </tr>
            </table>
            
            
            <h2 tal:condition="not:view/isOrdered">Step 4: PayPal checkout</h2>
            <p tal:condition="not:view/isOrdered">
              PayPal will ask you to enter your shipping address.<br />
              <a href="#" tal:attributes="href string:${context/absolute_url}/paypal_checkout">
                <img src="https://www.paypal.com/en_US/DE/i/btn/btn_buynowCC_LG.gif" alt="PayPal Checkout" />
              </a>
            </p>
          </div>
        </div>
      </tal:main-macro>
    </metal:main>
  </body>
</html>
