<html xmlns="http://www.w3.org/1999/xhtml" xmlns:tal="http://xml.zope.org/namespaces/tal" xmlns:metal="http://xml.zope.org/namespaces/metal" xmlns:i18n="http://xml.zope.org/namespaces/i18n" xml:lang="en" lang="en" metal:use-macro="context/main_template/macros/master" i18n:domain="fritzing.fab">
  <head>
      <metal:block fill-slot="style_slot">
          <link rel="stylesheet" type="text/css" 
              tal:define="navroot context/@@plone_portal_state/navigation_root_url"
              tal:attributes="href string:${navroot}/++resource++fritzing.fab/styles.css"
              />
      </metal:block>
      <metal:block fill-slot="javascript_head_slot">
          <script type="text/javascript" 
              tal:define="navroot context/@@plone_portal_state/navigation_root_url"
              tal:attributes="src string:${navroot}/++resource++fritzing.fab/fab.js"
              >
          </script>
      </metal:block>
  </head>
  <body>
    <metal:main fill-slot="main">
      <tal:main-macro metal:define-macro="main">
        <h1 tal:condition="python:view.isStateId(context, 'open')" class="documentFirstHeading">Order your PCBs</h1>
        <h1 tal:condition="python: not view.isStateId(context, 'open')" class="documentFirstHeading">Review your Order</h1>
        <div id="content-core">
          
          
          <h2 tal:condition="python:view.isStateId(context, 'open')">Step 1: Upload your sketches</h2>
          <h2 tal:condition="python: not view.isStateId(context, 'open')">Sketches</h2>
          
          <div tal:condition="not:container/listFolderContents">
            <p>no sketches, bla bla</p>
            <a class="addSketchLink" href="#" tal:attributes="href string:${context/absolute_url}/++add++sketch">Add Sketch</a>
          </div>
          
          <table class="sketchesTable" tal:condition="container/listFolderContents">
            <tbody>
              <tr tal:condition="python:view.isStateId(context, 'open')">
                <td class="actionCell"><a class="addSketchLink" href="#" tal:attributes="href string:${context/absolute_url}/++add++sketch">Add a sketch</a></td>
                <td></td>
                <td tal:condition="python:view.isStateId(context, 'open')"></td>
              </tr>
              <tr tal:repeat="sketch container/listFolderContents">
                <td class="sketchCell">
                  <div>
                    <span tal:content="sketch/copies"></span> × 
                      <a tal:define="filename sketch/orderItem/filename;
                                     filename_encoded python:view.encodeFilename(filename);"
                         tal:content="filename"
                         tal:attributes="href string:${sketch/absolute_url}/@@download/orderItem/${filename_encoded};
                                         title string:Download ${filename}"></a>
                  </div>
                  <table class="boardPreviewTable">
                    <tr>
                      <td class="boardPreview" 
                        tal:attributes="style python: 'width: %.2fcm;; height: %.02fcm;;' % (sketch.width/2.0, sketch.height/2.0)" 
                        tal:content="python: '%.2f cm²' % (sketch.area)">
                      </td>
                      <td tal:content="python: '%.2f cm' % (sketch.height)"></td>
                    </tr>
                    <tr>
                      <td tal:content="python: '%.2f cm' % (sketch.width)"></td>
                      <td></td>
                    </tr>
                  </table>
                  <div tal:condition="sketch/check">+ Quality check</div>
                </td>
                <td class="priceCell">
                  <div tal:content="python: '%.2f EUR' % (sketch.copies * sketch.area * context.pricePerSquareCm)"></div>
                  <div tal:condition="sketch/check">10.00 EUR</div>
                </td>
                <td class="actionCell" tal:condition="python:view.isStateId(context, 'open')">
                  <a class="editSketchLink" tal:condition="view/isManager" href="#" tal:attributes="href string:${sketch/absolute_url}/edit">edit</a><br />
                  <a class="deleteSketchLink" href="#" tal:attributes="href string:${sketch/absolute_url}/delete_confirmation">delete</a>
                </td>
              </tr>
              <tr>
                <td class="actionCell"><a tal:condition="python:view.isStateId(context, 'open')" class="addSketchLink" href="#" tal:attributes="href string:${context/absolute_url}/++add++sketch">Add a sketch</a></td>
                <td class="sumCell priceCell" tal:content="python: '%.2f EUR' % (context.priceTotalNetto)"></td>
                <td tal:condition="python:view.isStateId(context, 'open')"></td>
              </tr>
            </tbody>
          </table>
          
          
          <div tal:condition="python: (context.area > 0)">
            <h2 tal:condition="python:view.isStateId(context, 'open')">Step 2: Provide shipping and contact information</h2>
            <h2 tal:condition="python: not view.isStateId(context, 'open')">Shipping and contact information</h2>
          
            <div tal:condition="python: not context.shipTo">
              <p>
                please add your e-mail address and shipping destination to complete your order:<br />
                <a class="editAddressLink" href="#" tal:attributes="href string:${context/absolute_url}/edit">Add a shipping destination</a>
              </p>
            </div>
          
            <table class="blind" tal:condition="python: context.shipTo">
              <tr>
                <td>E-Mail: </td>
                <td tal:content="context/email"></td>
              </tr>
              <tr>
                <td>Shipping Area: </td>
                <td tal:content="view/shipToTitle"></td>
              </tr>
              <tr tal:condition="python:view.isStateId(context, 'open')">
                <td colspan="2"><a class="editAddressLink" href="#" tal:attributes="href string:${context/absolute_url}/edit">Edit</a></td>
              </tr>
            </table>
          </div>
          
          
          <div tal:condition="python: (context.area > 0 and context.shipTo and context.email)">
        
            <h2 tal:condition="python:view.isStateId(context, 'open')">Step 3: Review your order</h2>
            <h2 tal:condition="python: not view.isStateId(context, 'open')">Summary</h2>
        
            <table class="blind">
              <tr>
                <td class="align_right" tal:content="python: '%.2f cm²' % (context.area)"></td>
                <td>PCB Area (<span tal:content="context/pricePerSquareCm"></span> EUR/cm²)</td>
                <td class="align_right" tal:content="python: '%.2f EUR' % (context.priceNetto)"></td>
              </tr>
              <tr tal:condition="python: (context.numberOfQualityChecks > 0)">
                <td class="align_right"><span tal:content="context/numberOfQualityChecks"></span>×</td>
                <td>Sketch quality check</td>
                <td class="align_right" tal:content="python: '%.2f EUR' % (context.priceQualityChecksNetto)"></td>
              </tr>
              <tr>
                <td></td>
                <td>Total Netto</td>
                <td class="align_right" tal:content="python: '%.2f EUR' % (context.priceTotalNetto)"></td>
              </tr>
              <tr>
                <td></td>
                <td>Taxes (<span tal:content="context/taxesPercent"></span>%)</td>
                <td class="align_right" tal:content="python: '%.2f EUR' % (context.taxes)"></td>
              </tr>
              <tr>
                <td></td>
                <td>Shipping to <span tal:replace="view/shipToTitle" /></td>
                <td class="align_right" tal:content="python: '%.2f EUR' % (context.priceShipping)"></td>
              </tr>
              <tr>
                <td></td>
                <td>Total</td>
                <td class="align_right" tal:content="python: '%.2f EUR' % (context.priceTotalBrutto)"></td>
              </tr>
            </table>
            
            
            <h2 tal:condition="python:view.isStateId(context, 'open')">Step 4: PayPal checkout</h2>
            <p tal:condition="python:view.isStateId(context, 'open')">
              PayPal will ask you to enter your shipping address.<br />
              <a href="#" tal:attributes="href string:${context/absolute_url}/paypal_checkout">
                <img src="https://www.paypal.com/en_US/DE/i/btn/btn_buynowCC_LG.gif" alt="PayPal Checkout" />
              </a>
            </p>
          </div>
        </div>
      </tal:main-macro>
    </metal:main>
  </body>
</html>
